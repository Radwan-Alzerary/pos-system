// Convert the JSON string to a JavaScript object
const data = JSON.parse(`        {
  "year": [
      {
          "yearnum": 2023,
          "invoiceCount": 114,
          "foodCount": 332,
          "foodCost": 16479000,
          "sellprice": 352843903,
          "profit": 336364903,
          "month": [
              {
                  "monthnum": 7,
                  "invoiceCount": 102,
                  "foodCount": 299,
                  "foodCost": 1417500,
                  "sellprice": 25321486,
                  "profit": 23903986,
                  "day": [
                      {
                          "daynum": 16,
                          "foodCount": 85,
                          "foodCost": 280500,
                          "sellprice": 6293448,
                          "invoices": [
                              "64b3d96fe51be3df82d2ca5a",
                              "64b480d376fec31a1352c992",
                              "64b3bde5599d816febb03f27",
                              "64b3de2ebc7681d4e8c4260f",
                              "64b3c9c479a9801722fc83df",
                              "64b3cc310acb8deb8972e8c6",
                              "64b3654460a80f0c70b91335",
                              "64b36033dd7c0886d66978ee",
                              "64b35db7f8b4372f98ec2350",
                              "64b3ca6479a9801722fc842a",
                              "64b471a6bc7681d4e8c42687",
                              "64b35e4af3e945eebfc9fe67",
                              "64b3ca9b79a9801722fc849f",
                              "64b35e031fae9f011edc4c1d",
                              "64b480d376fec31a1352c98f",
                              "64b3c9ae79a9801722fc83bd",
                              "64b3de2ebc7681d4e8c42615",
                              "64b35e819d32a030d118bc07",
                              "64b363e5076aaad2ea5069c4",
                              "64b3ca8479a9801722fc8462",
                              "64b3601bd83634663b006051",
                              "64b3cdb10c44ba95c7fb91da",
                              "64b3cc490acb8deb8972e928",
                              "64b3cac86140159838b246d4",
                              "64b3be22b083745c2076ca4e",
                              "64b3ce1ae51be3df82d2ca06",
                              "64b35ff36093582f57af451c",
                              "64b3d961e51be3df82d2ca2d",
                              "64b3cdb80c44ba95c7fb921a",
                              "64b35e1d1fae9f011edc4c3f",
                              "64b35db7f8b4372f98ec2354",
                              "64b3cad66140159838b2471f",
                              "64b3cc430acb8deb8972e8e8"
                          ],
                          "profit": 6012948,
                          "invoiceCount": 33
                      },
                      {
                          "daynum": 14,
                          "foodCount": 11,
                          "foodCost": 19500,
                          "sellprice": 637499,
                          "invoices": [
                              "64b1677ba05c6429f67ce827",
                              "64b16b66a05c6429f67ce8bc",
                              "64b16128a1a296e67299d0d3",
                              "64b16779a05c6429f67ce7fa",
                              "64b1bf5a8231a1f1acfb513c",
                              "64b1bd738231a1f1acfb50c5",
                              "64b16768a05c6429f67ce78b",
                              "64b16cd3a05c6429f67ce944",
                              "64b1bf5d8231a1f1acfb5171",
                              "64b15eb02868077919b3be4c",
                              "64b1b61cfdfa4808c16b6562"
                          ],
                          "profit": 617999,
                          "invoiceCount": 11
                      },
                      {
                          "daynum": 15,
                          "foodCount": 32,
                          "foodCost": 66000,
                          "sellprice": 2213918,
                          "invoices": [
                              "64b1eccd043374e908b4d316",
                              "64b1f739531fb96b76bb0ca4",
                              "64b1f7d1531fb96b76bb0cdd",
                              "64b1eb1626932825e3006d1a",
                              "64b20374d33078c50a8a9eb0",
                              "64b26a71e86515b6b2b64e38",
                              "64b1f7c7531fb96b76bb0cc6",
                              "64b26a73e86515b6b2b64e70",
                              "64b1f6dd531fb96b76bb0c82",
                              "64b1eb0e26932825e3006cbe",
                              "64b20307e70dae05c81cf657",
                              "64b1e806213a0eb2718f5561",
                              "64b1eb1f26932825e3006d72",
                              "64b20303e70dae05c81cf602"
                          ],
                          "profit": 2147918,
                          "invoiceCount": 14
                      },
                      {
                          "daynum": 18,
                          "foodCount": 61,
                          "foodCost": 421500,
                          "sellprice": 3184608,
                          "invoices": [
                              "64b6829187a87f35d2f3d092",
                              "64b68365bcf66ee26a0ffe0a",
                              "64b66f6997cfbc7bfec6e213",
                              "64b60f4b9e7c490b5dcad6ae",
                              "64b615b24d01103c5995470b",
                              "64b61344ecf5f69809b51277",
                              "64b60f3d9e7c490b5dcad670",
                              "64b5df2791bc8cfda7ce6c08",
                              "64b5fe1849250ee4d2577da5",
                              "64b60f4b9e7c490b5dcad6aa",
                              "64b68387bcf66ee26a0ffe4a",
                              "64b615ad4d01103c599546d8",
                              "64b617875ef8f953c6e9ffe7",
                              "64b615b24d01103c59954707",
                              "64b683b0dd819e1ca0256722",
                              "64b68452eb6831550b963494",
                              "64b6a019561cdededf7a8a9d",
                              "64b68d97eb6831550b96351d",
                              "64b67271d2f38ed4e379abe3"
                          ],
                          "profit": 2763108,
                          "invoiceCount": 19
                      },
                      {
                          "daynum": 31,
                          "foodCount": 4,
                          "foodCost": 13500,
                          "sellprice": 913844,
                          "invoices": [
                              "64c7c1c6aae34b66ea7d147e"
                          ],
                          "profit": 900344,
                          "invoiceCount": 1
                      },
                      {
                          "daynum": 17,
                          "foodCount": 1,
                          "foodCost": 0,
                          "sellprice": 3000,
                          "invoices": [
                              "64b489d891bc8cfda7ce6779"
                          ],
                          "profit": 3000,
                          "invoiceCount": 1
                      },
                      {
                          "daynum": 20,
                          "foodCount": 93,
                          "foodCost": 592500,
                          "sellprice": 10377173,
                          "invoices": [
                              "64b961145f2730e9497baaaf",
                              "64b95f7efc4a628f7b713ef2",
                              "64b95f43fc4a628f7b713e64",
                              "64b9546bfc4a628f7b71370e",
                              "64b95477fc4a628f7b713762",
                              "64b98d97d233b27cbb92e7f6",
                              "64b99ea1d233b27cbb92ea07",
                              "64b954c4fc4a628f7b71381d",
                              "64b98d91d233b27cbb92e7c6",
                              "64b99ea4d233b27cbb92ea35",
                              "64b961155f2730e9497baab3",
                              "64b9546bfc4a628f7b71370a",
                              "64b961465f2730e9497bab6e",
                              "64b961305f2730e9497bab45",
                              "64b95477fc4a628f7b71375f",
                              "64b953ffa518b9b70dfcdc5e",
                              "64b9625472d3c9df61534c62",
                              "64b9546bfc4a628f7b713715",
                              "64b96273349925773a648f9f",
                              "64b96a5bd233b27cbb92e440"
                          ],
                          "profit": 9784673,
                          "invoiceCount": 20
                      },
                      {
                          "daynum": 27,
                          "foodCount": 12,
                          "foodCost": 24000,
                          "sellprice": 1697996,
                          "invoices": [
                              "64c25af2484099d4886c0461",
                              "64c25af2484099d4886c0464",
                              "64c25af2484099d4886c045e"
                          ],
                          "profit": 1673996,
                          "invoiceCount": 3
                      }
                  ]
              },
              {
                  "monthnum": 8,
                  "invoiceCount": 12,
                  "foodCount": 33,
                  "foodCost": 15061500,
                  "sellprice": 327522417,
                  "profit": 312460917,
                  "day": [
                      {
                          "daynum": 3,
                          "foodCount": 28,
                          "foodCost": 15055500,
                          "sellprice": 327472417,
                          "invoices": [
                              "64cb065f780f0ed567eda04e",
                              "64cb1277614bfece10ee5a97",
                              "64cb147ff90d9622dfb2d8a1",
                              "64cc1a4b3266c51fad1a1a06",
                              "64cbcb6b798600d7cdf79a38",
                              "64cc1a543266c51fad1a1a4d",
                              "64cc1a5c3266c51fad1a1a91",
                              "64cc239317ed6349ab62de5a",
                              "64cb066a780f0ed567eda07f",
                              "64cbd56d9d7d07eb6c5a8a2e"
                          ],
                          "profit": 312416917,
                          "invoiceCount": 10
                      },
                      {
                          "daynum": 5,
                          "foodCount": 5,
                          "foodCost": 6000,
                          "sellprice": 50000,
                          "invoices": [
                              "64cda7803ce38f20dec913a9",
                              "64cda7783ce38f20dec9135e"
                          ],
                          "profit": 44000,
                          "invoiceCount": 2
                      }
                  ]
              }
          ]
      }
  ]
}
`);
// Function to get daily data for a specific date
function getDailyDataForDate(date) {
  const result = { invoiceCount: 0, foodCount: 0, foodCost: 0, sellprice: 0, profit: 0 };

  // Iterate through the years
  for (const year of data.year) {
    // Iterate through the months in the year
    for (const month of year.month) {
      // Check if the month is within the date range
      const monthDate = new Date(Date.UTC(year.yearnum, month.monthnum - 1)); // Use UTC method
      if (monthDate.getUTCFullYear() === date.getUTCFullYear() && monthDate.getUTCMonth() === date.getUTCMonth()) {
        // Iterate through the days in the month
        for (const day of month.day) {
          // Check if the day is within the date range
          if (day.daynum === date.getUTCDate()) { // Use UTC method
            result.invoiceCount = day.invoiceCount || 0;
            result.foodCount = day.foodCount || 0;
            result.foodCost = day.foodCost || 0;
            result.sellprice = day.sellprice || 0;
            result.profit = day.profit || 0;
            return result;
          }
        }
      }
    }
  }

  return result;
}

// Function to get aggregated monthly data for a specific month
function getMonthlyDataForMonth(month) {
  const nextMonth = new Date(month);
  nextMonth.setUTCMonth(nextMonth.getUTCMonth() + 1); // Set to the first day of the next month
  nextMonth.setUTCDate(nextMonth.getUTCDate() - 1); // Set to the last day of the current month
  const monthData = {
    startDate: month.toISOString().slice(0, 10), // Format date as "YYYY-MM-DD"
    endDate: nextMonth.toISOString().slice(0, 10), // Format date as "YYYY-MM-DD"
    ...getDailyDataForDate(month), // Get data for the first day of the month
  };

  // Calculate totals for the month
  monthData.totalInvoiceCount = 0;
  monthData.totalFoodCount = 0;
  monthData.totalFoodCost = 0;
  monthData.totalSellprice = 0;
  monthData.totalProfit = 0;

  for (let date = new Date(month); date <= nextMonth; date.setUTCDate(date.getUTCDate() + 1)) {
    const dataForDate = getDailyDataForDate(date);
    monthData.totalInvoiceCount += dataForDate.invoiceCount;
    monthData.totalFoodCount += dataForDate.foodCount;
    monthData.totalFoodCost += dataForDate.foodCost;
    monthData.totalSellprice += dataForDate.sellprice;
    monthData.totalProfit += dataForDate.profit;
  }

  return monthData;
}

// Define the date range (start date is August 10, 2023, and end date is today's date)
const startDate = new Date(Date.parse("2023-08-1")); // August 10, 2023
const endDate = new Date(); // Today's date

// Set the time of both startDate and endDate to midnight (00:00:00)
startDate.setUTCHours(0, 0, 0, 0);
endDate.setUTCHours(0, 0, 0, 0);

// Function to generate an array of dates between two dates (inclusive)
function generateDateRange(startDate, endDate) {
  const dates = [];
  let currentDate = new Date(startDate);
  while (currentDate <= endDate) {
    dates.push(new Date(currentDate));
    currentDate.setUTCDate(currentDate.getUTCDate() + 1);
  }
  return dates;
}

// Function to generate an array of months between two dates (inclusive)
function generateMonthRange(startDate, endDate) {
  const months = [];
  let currentDate = new Date(startDate);
  currentDate.setUTCDate(1); // Set the date to the first day of the month
  while (currentDate <= endDate) {
    months.push(new Date(currentDate));
    currentDate.setUTCMonth(currentDate.getUTCMonth() + 1); // Move to the next month
  }
  return months;
}

// Generate the date range between startDate and endDate
const dateRange = generateDateRange(startDate, endDate);

// Generate the month range between startDate and endDate
const monthRange = generateMonthRange(startDate, endDate);

// Get daily data for each date in the range
const dailyData = dateRange.map(date => ({
  date: date.toISOString().slice(0, 10), // Format date as "YYYY-MM-DD"
  ...getDailyDataForDate(date),
}));

// Get aggregated monthly data for each month in the range
const monthlyData = monthRange.map(month => getMonthlyDataForMonth(month));

console.log("Daily Data:");
console.log(dailyData);
console.log("\nMonthly Data:");
console.log(monthlyData);
